<krpano>

     <action name="draglayer_text">
		if(%1 != dragging,
			copy(drag_currenty, y);
			copy(drag_stagey, mouse.stagey);
			draglayer_text(dragging,%2);
		  ,
			if(pressed,
				sub(dy, mouse.stagey, drag_stagey);
				add(y1, drag_currenty, dy);
				add(y2, y1, pixelheight);
				sub(y2, %2);
				if(y1 GT 0, set(y1,0));
				if(y2 LT 0, sub(y1,y2));
				copy(y,y1);
				delayedcall(0, draglayer_text(dragging,%2) );
			  );
		  );
	</action>

    <action name="picture_resize">

	div(aspect, layer[%1].imagewidth, layer[%1].imageheight);
	mul(new_width, layer[get(layer[%1].parent)].width, 0.9);<!-- 显示图片比例 -->
	div(new_height, new_width, aspect);
	mul(max_height, layer[get(layer[%1].parent)].height, 0.9);<!-- 显示图片比例 -->
	if(new_height GT max_height,
		copy(new_height, max_height);
		mul(new_width, new_height, aspect);
	  );
	roundval(new_width);
	roundval(new_height);
	copy(layer[%1].width, new_width);
	copy(layer[%1].height, new_height);
   </action>

   <action name="picture_resize_stage">
	<!-- 使用屏幕宽度或高度的百分之九十 -->	
	div(aspect, layer[%1].imagewidth, layer[%1].imageheight);
	mul(new_width, stagewidth, 0.8); <!-- 放大图片比例 -->
	div(new_height, new_width, aspect);
	mul(max_height, stageheight, 0.8);
	if(new_height GT max_height,
		copy(new_height, max_height);
		mul(new_width, new_height, aspect);
	  );
	roundval(new_width);
	roundval(new_height);
	copy(layer[%1].width, new_width);
	copy(layer[%1].height, new_height);
    </action>

       
	<layer name="textbox_10"  type="container" visible="false" align="center" x="0" y.normal="-5%" y.mobile="5%" scale.normal="1" scale.mobile="0.5" width="600" height="400"  bgroundedge="3" bgcolor="0x333333" bgalpha="0.8" bgcapture="true" bgborder="3 0xFFFFFF 1" scalechildren="true" children="true" >
		<layer name="title_10" url="%SWFPATH%/plugins/textfield.swf" children="false" enabled="false" align="top" y="5%" width="100%" autoheight="true"
		           border="false" background="false" 
			       css="text-align:center; color:#FFFFFF; font-family:Arial; font-weight:bold; font-size:18px;"
			       html="视障阅览室"
			       />

        <layer name="button_close_mask_10"  type="container" align="righttop" edge="center"  y="5" x="5" width="30" height="30" bgroundedge="30" bgcolor="0x000000" bgalpha="1" bgcapture="true" bgborder="3 0xFFFFFF 1"  >

        	<layer name="button_close_10" url="%SWFPATH%/skin/close.png" children="false" enabled="true" align="center"   width="22" height="22" onclick="set(layer[textbox_10].visible,false); " 
			       />

		</layer>	       
        
        <layer name="pic_mask_10" type="container" align="leftbottom" x="2.5%" y="0" width="300" height="350" bgcolor="0xFFFFFF" bgalpha="0" maskchildren="true">

            <layer name="pic_10" url="%SWFPATH%/hotspot/1.jpg" align="center"  onloaded="picture_resize(get(name));" state="small" onhover="showtext(点击放大)" 
                onclick="
            	if(state == small,
            	set(parent,stage);picture_resize_stage(get(name));set(onhover,showtext(点击关闭));set(state,big),
            	set(parent,pic_mask_10);picture_resize(get(name));set(onhover,showtext(点击放大));set(state,small));"  />

        </layer>

		<layer name="textmask_10" type="container" align="right" x="5%" y="5%" width="220" height="250" bgcolor="0xFFFFFF" bgalpha="0" maskchildren="true">
			<layer name="text_10" url="%SWFPATH%/plugins/textfield.swf" children="false" align="top" x="0" y.normal="20%" y.mobile="10%" width="100%" autoheight="true"
			       border="false" background="false"
			       css="text-align:left; color:#FFFFFF; font-family:Arial; font-size:15px;"
			       html="data:testtext_10"
			       />
		</layer>

		</layer>
	
	<data name="testtext_10">
       　　爱心阅览室里有盲文书、大字阅读机、助视仪、读频听书、视障电脑等专用设施设备，还有手推自助轮椅，特别是定期组织开展的各类趣味有益的读书文化活动更是为残障朋友们搭建了一个心灵交融、学习体验的平台。
	</data>

	
	
	<krpano devices="mobile">
   
	 <layer name="textbox_10" >
    	<layer name="button_close_mask_10" width="50" height="50" >
		<layer name="button_close_10"  width="45" height="45" />
		</layer>
		<layer name="pic_mask_10" >
		<layer name="pic_10" onclick=""/>
	    </layer>
		<layer name="textmask_10" >
			<layer name="text_10" 
			       css="text-align:left; color:#FFFFFF; font-family:Arial; font-size:10px;"
			       />
		</layer>

		</layer>
	 
	</krpano>

</krpano>